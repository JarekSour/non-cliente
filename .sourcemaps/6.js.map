{"version":3,"sources":["../../src/pages/map/map.module.ts","../../src/pages/map/map.ts"],"names":[],"mappings":"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","file":"6.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { MapPage } from './map';\n\n@NgModule({\n  declarations: [\n    MapPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(MapPage),\n  ],\n})\nexport class MapPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/map/map.module.ts","import { Component, ViewChild, ElementRef } from '@angular/core';\nimport { IonicPage, Platform, NavController, NavParams, MenuController, AlertController, ToastController } from 'ionic-angular';\nimport { SplashScreen } from '@ionic-native/splash-screen';\nimport { Diagnostic } from '@ionic-native/diagnostic';\nimport { Geolocation } from '@ionic-native/geolocation';\nimport { MarketServiceProvider } from '../../providers/market-service/market-service';\nimport { PersonServiceProvider } from '../../providers/person-service/person-service';\n\ndeclare var google;\n\n@IonicPage()\n@Component({\n\tselector: 'page-map',\n\ttemplateUrl: 'map.html',\n})\nexport class MapPage {\n\t@ViewChild('map') mapElement: ElementRef;\n\tdirectionsService = new google.maps.DirectionsService;\n\tdirectionsDisplay = new google.maps.DirectionsRenderer;\n\torderId: any;\n\tmap: any;\n\terrorGPS: boolean;\n\terrorPermiso: boolean;\n\tinitmap: boolean;\n\tinterval: any;\n\tposition: any;\n\tdestino: any;\n\tphoto: any;\n\tname: any;\n\trutAgente: any;\n\n\tconstructor(\n\t\tpublic platform: Platform,\n\t\tpublic splashScreen: SplashScreen,\n\t\tpublic navCtrl: NavController,\n\t\tpublic menuCtrl: MenuController,\n\t\tpublic toastCtrl: ToastController,\n\t\tpublic marketService: MarketServiceProvider,\n\t\tpublic personService: PersonServiceProvider,\n\t\tpublic alertCtrl: AlertController,\n\t\tpublic geolocation: Geolocation,\n\t\tpublic diag: Diagnostic,\n\t\tpublic navParams: NavParams) {\n\n\t\tthis.platform.ready().then(() => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.splashScreen.hide();\n\t\t\t}, 100)\n\t\t})\n\t\tthis.errorGPS = false;\n\t\tthis.errorPermiso = false;\n\t\tthis.initmap = true;\n\t}\n\n\tionViewDidLoad() {\n\t\tthis.menuCtrl.enable(false, 'menuSlide');\n\t\tthis.chkGps();\n\t}\n\n\tchkGps() {\n\t\tthis.interval = setInterval(() => {\n\t\t\tthis.diag.isLocationEnabled().then((isAvailable) => {\n\t\t\t\tif (isAvailable) {\n\t\t\t\t\tthis.errorGPS = false;\n\t\t\t\t\tthis.errorPermiso = false;\n\t\t\t\t\tif (this.initmap == true) {\n\t\t\t\t\t\tthis.iniciarMap();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.presentToast('Activa tu GPS');\n\t\t\t\t}\n\t\t\t}).catch((e) => {\n\t\t\t\tthis.errorPermiso = true;\n\t\t\t});\n\t\t}, 3000);\n\t}\n\n\tiniciarMap() {\n\t\tthis.orderId = localStorage.getItem(\"orderId_user\");\n\t\tthis.initmap = false;\n\n\t\tthis.marketService.getOrdenDeCompra({ i: this.orderId }).then((data) => {\n\t\t\tthis.rutAgente = data['data']['Agent'];\n\n\t\t\tthis.personService.getDataAgent({ r: this.rutAgente }).then((res) => {\n\t\t\t\tthis.name = res['data']['Name'] + ' ' + res['data']['LastName'];\n\t\t\t})\n\t\t\tthis.personService.getAvatar({ r: this.rutAgente, c: 'Avatar' }).then((res) => {\n\t\t\t\tif (res['data'] != false)\n\t\t\t\t\tthis.photo = res['data'];\n\t\t\t})\n\t\t});\n\n\t\tthis.geolocation.getCurrentPosition().then((resp) => {\n\t\t\tthis.map = new google.maps.Map(this.mapElement.nativeElement, {\n\t\t\t\tzoom: 13,\n\t\t\t\tcenter: { lat: resp.coords.latitude, lng: resp.coords.longitude },\n\t\t\t\tanimation: google.maps.Animation.DROP,\n\t\t\t\tmapTypeId: google.maps.MapTypeId.ROADMAP,\n\t\t\t\tstreetViewControl: false,\n\t\t\t\tmapTypeControl: false\n\t\t\t});\n\n\t\t\tlet aux = localStorage.getItem('g').split(',');\n\t\t\tthis.destino = new google.maps.LatLng(parseFloat(aux[0]), parseFloat(aux[1]));\n\t\t\tthis.position = new google.maps.LatLng(resp.coords.latitude, resp.coords.longitude);\n\n\t\t\tthis.directionsDisplay.setMap(this.map);\n\n\t\t\tthis.calculateAndDisplayRoute(this.position);\n\n\t\t}).catch((error) => {\n\t\t\tthis.presentToast('Ups! ocurrio un error (101)');\n\t\t});\n\t}\n\n\tcalculateAndDisplayRoute(myPosition) {\n\t\tthis.directionsService.route({\n\t\t\torigin: this.destino,\n\t\t\tdestination: myPosition,\n\t\t\ttravelMode: 'DRIVING'\n\t\t}, (response, status) => {\n\t\t\tif (status === 'OK') {\n\t\t\t\tthis.directionsDisplay.setDirections(response);\n\t\t\t} else {\n\t\t\t\tthis.presentToast('Ups! ' + status);\n\t\t\t}\n\t\t});\n\t}\n\n\tcancelarPedido() {\n\t\tlet confirm = this.alertCtrl.create({\n\t\t\ttitle: 'Alerta',\n\t\t\tmessage: '¿Estas seguro que deseas cancelar el pedido?',\n\t\t\tenableBackdropDismiss: false,\n\t\t\tbuttons: [\n\t\t\t\t{\n\t\t\t\t\ttext: 'Aceptar',\n\t\t\t\t\thandler: () => {\n\t\t\t\t\t\tthis.marketService.getPlayerIdAgent({ r: this.rutAgente }).then((data) => {\n\t\t\t\t\t\t\tthis.marketService.cancelarCompra({ i: this.orderId, rs: 'Cancelado Member', pi: data['data']['Player_ids'] }).then((res) => {\n\t\t\t\t\t\t\t\tif (res['data'] == true) {\n\t\t\t\t\t\t\t\t\tlocalStorage.removeItem('g');\n\t\t\t\t\t\t\t\t\tlocalStorage.removeItem('orderId_user');\n\t\t\t\t\t\t\t\t\tlocalStorage.removeItem('en_camino_user');\n\t\t\t\t\t\t\t\t\tlet alert = this.alertCtrl.create({\n\t\t\t\t\t\t\t\t\t\ttitle: 'Alerta',\n\t\t\t\t\t\t\t\t\t\tsubTitle: 'Tu pedido fue cancelado exitosamente',\n\t\t\t\t\t\t\t\t\t\tenableBackdropDismiss: false,\n\t\t\t\t\t\t\t\t\t\tbuttons: [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\ttext: 'Aceptar',\n\t\t\t\t\t\t\t\t\t\t\t\thandler: data => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.navCtrl.setRoot('HomePage');\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\talert.present();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthis.presentToast('Ups! ocurrio un error');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: 'Cancelar',\n\t\t\t\t\thandler: () => { }\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\t\tconfirm.present();\n\t}\n\n\tpresentToast(msg) {\n\t\tlet toast = this.toastCtrl.create({\n\t\t\tmessage: msg,\n\t\t\tduration: 3000,\n\t\t\tposition: 'bottom',\n\t\t\tdismissOnPageChange: true\n\t\t});\n\n\t\ttoast.present();\n\t}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/map/map.ts"],"sourceRoot":""}